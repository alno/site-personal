<h2>Настройка системы поиска</h2>

<p>Для начала, разумеется, необходимо создать систему пользовательского поиска. Это можно сделать на странице <a href="http://www.google.com/cse/">Custom Search Engine</a>. При создании системы в список сайтов необходимо, разумеется включить свой сайт (или сайты). </p>

<p>Затем, в настройках системы зайти в раздел Уточнения(Refinements). Там можно добавить уточнение, возникает форма вида (например, сначала добавим раздел Ruby):</p>

<p style="text-align: center;"><img src="/images/google-cse/google-cse-ruby.png" /></p>

<p>Основная проблема состоит в том, что написать в строке слов, чтобы выбрать все страницы, содержащие тэг <b>Ruby</b>.</p>

<p>Пришлось поискать описание различных операторов расширенного поиска для Google. Наиболее подробное описание различных операторов поиска я нашел <a href=":http://www.googleguide.com/advanced_operators.html" rel="nofollow">здесь</a>. Однако, для решения задачи мне понадобились всего три:</p>

<ul>
<li><tt>|</tt> - альтернативные варианты (или).</li>
<li><tt>[</tt> и <tt>]</tt> - скобки для группировки элементов в запросах.</li>
<li><tt>*</tt> - оператор, который обозначает одно произвольное слово. Например в запросе <b>"Мама * раму"</b> вместо * может находится ровно одно слово, то есть по этому запросу найдется текст "мама мыла раму", но не "мама мыла большую раму" или "мама раму".</li>
</ul>

<p>Далее, в начале каждой записи после заголовка я вставил код, выводящий список всех тэгов записи, перед которым находилось слово "тэги". После этого пришлось подождать некоторое время, пока Google переиндексирует все страницы сайта =).

<p>После того, как все страницы переиндексированы, можно легко выделить все, у которых первым тэгом является Ruby с помощью запроса <b>"Тэги: Ruby"</b>

<p>Теперь необходимо учесть то, что тэг Ruby стоит не всегда на первом месте. Здесь-то и нужен оператор * - запрос для тэга на втором месте выглядит как <b>"Тэги: * Ruby"</b>. Аналогично для третьего, четвертого и далее.</p>

<p>Чтобы сделать запрос, который выбирает все страницы, содержащие тэг на любом из первых N мест можно задать следующую конструкцию: <b>["Тэги: Ruby"|"Тэги: * Ruby"|"Тэги: * * Ruby"|"Тэги: * * * Ruby"|"Тэги: * * * Ruby"]</b>. Тут N=5. Если Вы ставите больше тэгов, то запрос придется сделать несколько длинее.</b></p>

<p>Полученную строку запроса необходимо записать в "слова, добавляемые в поисковый запрос", а затем нажать "Сохранить". Повторив описанную процедуру для необходимых тэгов на страницу поиска можно получить следующую строку навигации:</p>

<p style="text-align: center;"><img src="/images/google-cse/google-cse-results.png" /></p>

<h2>Форма поиска</h2>

<p>Для поиска Google предлагает AJAX-форму, однако мне больше понравился вариант стандартной формы:</p>

<r:code lang="html">
<form action="http://www.google.com/cse" id="cse-search-box">
<input name="cx" value="012005588861949235995:unlj7xfsgyy" type="hidden">
<input name="ie" value="UTF-8" type="hidden">
<input name="q" size="30" type="text">
<input name="sa" value="Найти" type="submit">
</form>
</r:code>

<p><b>012005588861949235995:unlj7xfsgyy</b> - это идентификатор моей системы поиска. Соответственно, для Вашей системы он будет другой, найти его можно, например, в URL при редактировании системы поиска.</p>
